# What has been updated?

## Changelog - (Added, Fixed, Removed):

1. Added new NUI menu for performing multiple actions - (playerlist & actions, tickets management, bans management, admin history actions).
2. Added ticket system to create a ticket to inform administrators - staff.

## Modified Files:

- REPLACE THE WHOLE SCRIPT, DO NOT KEEP ANYTHING FROM THE CURRENT ONE, DELETE AND PLACE.

## Notes

1. Update **TPZ-CORE** && **TPZ-INVENTORY** to latest! There have been some unreleased file updates for supporting the new Admin NUI. What you should update from both scripts are the **commands.lua** file and add the **new locale** (on both scripts) which is:

```lua
['COMMAND_HISTORY_ACTION_DESCRIPTION']    = "Executed Command: %s",
```

I also highly suggest replacing from both the API lua files to latest.

3. Add the following database tables related to the new update:

```lua

CREATE TABLE IF NOT EXISTS `admin_history` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `identifier` varchar(40) NOT NULL,
  `steamname` varchar(50) NOT NULL,
  `action` longtext NOT NULL,
  `date` varchar(50) NOT NULL,
  `timestamp` int(11) NOT NULL,
  PRIMARY KEY (`id`) USING BTREE
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci ROW_FORMAT=DYNAMIC;

CREATE TABLE IF NOT EXISTS `admin_tickets` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `identifier` varchar(40) NOT NULL,
  `charidentifier` int(11) NOT NULL,
  `steamname` varchar(50) NOT NULL,
  `fullname` varchar(50) NOT NULL,
  `title` varchar(50) NOT NULL,
  `message` longtext NOT NULL,
  `exclamation` int(11) DEFAULT 0,
  `date` varchar(50) NOT NULL,
  `timestamp` int(11) DEFAULT NULL,
  PRIMARY KEY (`id`) USING BTREE
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci ROW_FORMAT=DYNAMIC;

```

3. Search on `tpz_core\server\discord\webhooks.lua` the `tpz_admin` option and add a new option (TICKETS) above `['COMMANDS']`. It should look like this:
```lua
    ['tpz_admin'] = {
        ['TICKETS'] = "xxxxxxxxxxxxxx", -- <-- NEW
        ['COMMANDS'] = "xxxxxxxxxxxxxxxx",
        ['DEVTOOLS_INJECTION_CHEAT'] = "xxxxxxxxxxxxxxxxxxxxxxxxx",
    },
```



